## 通用

+ 底层依赖镜像应使用Docker官方提供的镜像，具体为在[Docker Hub](https://store.docker.com)中镜像作者为`Docker`的镜像，或者是由有固定官方组织和机构维护的镜像，例如Oracle、Microsoft 、Google等。
+ 尽量的精简，以减小镜像的大小。
+ 减少[构建层级](#/构建层级)，减少不必要的构建时间。
+ 提供`.dockerignore`文件，详情参考[官方文档说明](https://docs.docker.com/engine/reference/builder/#dockerignore-file)。
+ 使用`Dockerfile`构建镜像。

## Dockerfile

`Dockerfile`一律使用`.yaml`格式编写。

其他标准需准守[官方文档](https://docs.docker.com/engine/reference/builder/)要求。

## 配置

应用的配置需要以配置文件形式存在。实际部署中可以通过覆盖该文件达到修改配置的目的。

在镜像说明文件中应该说明配置文件最终存在的路径，并应该有详细的文档说明每个配置项的含义。

## 健康检查

在调度容器时，需要判断容器是否已经就绪、健康。镜像应提供相应的命令供外部集群调度器调用。

### 容器就绪检查

在容器根目录下提供`ready-init.sh`文件用于检查容器是否已经准备就绪。

返回格式：当返回`0`时，调度系统认为容器已经准备就绪。

### 容器健康检查

在容器根目录下提供`healthy.sh`文件用于检查容器健康状态。

返回格式：当返回`0`时，调度系统认为容器是健康的，否则将会杀死容器，并重新调度。



## 附录

### 构建层级

在使用Dockerfile时，将自上而下逐行执行，将为每一行生成一个单独的镜像换成，一层一层逐渐堆叠。合理的将多行命令合并，例如：`echo "A" && echo "B" `，将可以有效减少内部构建镜像缓存的次数，有利于提升镜像的构建速度。